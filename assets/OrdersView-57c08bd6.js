import{M as v}from"./modal-d5df6647.js";import{_ as g,o as l,c as a,b as t,t as s,D as x,F as _,l as m,f as M,K as w,e as k,a as D,L as C,d as b,r as $}from"./index-c7c2c46e.js";import{P as L}from"./PaginationModal-08880827.js";const V={props:{tempOrders:{type:Object,default(){return{}},required:!0},data(){return{order:{}}},watch:{tempOrders(){this.order=this.tempOrders}}}},P={class:"modal-dialog modal-xl"},E={class:"modal-content border-0"},q=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"couponsModalLabel",class:"modal-title"},[t("span",null,"詳細訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T={class:"modal-body"},A={class:"row"},B={class:"col-md-6"},I=t("span",{class:"ms-2"},"訂購人資料",-1),S={class:"table"},U=t("th",null,"姓名",-1),j=t("th",null,"Email",-1),N=t("th",null,"電話",-1),F=t("th",null,"地址",-1),H={class:"col-md-6"},R=t("span",{class:"ms-2"},"訂購細節",-1),z={class:"table"},K=t("th",null,"訂單編號",-1),G=t("th",null,"訂購時間",-1),J=t("th",null,"付款狀態",-1),Q=t("th",null,"總金額",-1),W={class:"row"},X={class:"col"},Y=t("span",{class:"ms-2"},"訂購商品",-1),Z={class:"table"},tt={class:"text-end"},st={class:"form-check d-flex justify-content-end pe-5"},et=["id"],ot=["for"],dt={class:"modal-footer"},lt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function at(d,e,i,y,u,c){var p,r,h,n;return l(),a("div",P,[t("div",E,[q,t("div",T,[t("div",A,[t("div",B,[I,t("table",S,[t("tbody",null,[t("tr",null,[U,t("td",null,s((p=this.$props.tempOrders.user)==null?void 0:p.name),1)]),t("tr",null,[j,t("td",null,s((r=this.$props.tempOrders.user)==null?void 0:r.email),1)]),t("tr",null,[N,t("td",null,s((h=this.$props.tempOrders.user)==null?void 0:h.tel),1)]),t("tr",null,[F,t("td",null,s((n=this.$props.tempOrders.user)==null?void 0:n.address),1)])])])]),t("div",H,[R,t("table",z,[t("tbody",null,[t("tr",null,[K,t("td",null,s(this.$props.tempOrders.id),1)]),t("tr",null,[G,t("td",null,s(new Date(this.$props.tempOrders.create_at*1e3).toLocaleDateString()),1)]),t("tr",null,[J,t("td",null,[t("span",{class:x({"text-success":this.$props.tempOrders.is_paid,"text-danger":!this.$props.tempOrders.is_paid})},s(this.$props.tempOrders.is_paid?"已付款":"未付款"),3)])]),t("tr",null,[Q,t("td",null,s(this.$props.tempOrders.total),1)])])])]),t("div",W,[t("div",X,[Y,t("table",Z,[t("tbody",null,[(l(!0),a(_,null,m(this.$props.tempOrders.products,o=>(l(),a("tr",{key:o.id},[t("th",null,s(o.product.title),1),t("td",null,s(o.qty)+" / "+s(o.product.unit),1),t("td",tt,"$ "+s(o.final_total),1)]))),128))])])])]),t("div",st,[M(t("input",{class:"form-check-input",type:"checkbox",value:"",id:"{this.$props.tempOrders.id}","onUpdate:modelValue":e[0]||(e[0]=o=>this.$props.tempOrders.is_paid=o)},null,8,et),[[w,this.$props.tempOrders.is_paid]]),t("label",{class:"form-check-label px-3",for:"{this.$props.tempOrders.id}"},[t("span",null,s(this.$props.tempOrders.is_paid?"已付款":"未付款"),1)],8,ot)])])]),t("div",dt,[lt,t("button",{type:"button",class:"btn btn-custom_medium-green text-white",onClick:e[1]||(e[1]=o=>d.$emit("update-orders",d.order))}," 修改 ")])])])}const rt=g(V,[["render",at]]),nt={props:{tempOrders:{type:Object,default(){return{}},required:!0}}},it={class:"modal-dialog"},ct={class:"modal-content border-0"},pt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delOrdersModalLabel",class:"modal-title"},[t("span",null,"刪除訂單")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ut={class:"modal-body"},ht={class:"text-danger"},_t={class:"container"},mt={class:"row"},bt={class:"col"},$t=t("span",{class:"ms-2"},"訂購商品",-1),Ot={class:"table"},ft={class:"text-end"},gt={class:"modal-footer"},yt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function vt(d,e,i,y,u,c){var p;return l(),a("div",it,[t("div",ct,[pt,t("div",ut,[k(" 是否刪除 "),t("strong",ht,s((p=this.$props.tempOrders)==null?void 0:p.id),1),k(" 訂單(刪除後將無法恢復)。 ")]),t("div",_t,[t("div",mt,[t("div",bt,[$t,t("table",Ot,[t("tbody",null,[(l(!0),a(_,null,m(this.$props.tempOrders.products,r=>(l(),a("tr",{key:r.id},[t("th",null,s(r.product.title),1),t("td",null,s(r.qty)+" / "+s(r.product.unit),1),t("td",ft,"$ "+s(r.final_total),1)]))),128))])])])])]),t("div",gt,[yt,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=r=>d.$emit("delOrders"))},"確認刪除")])])])}const kt=g(nt,[["render",vt]]),{VITE_API:O,VITE_PATH:f}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"qoqvuedemo",BASE_URL:"/Vite_week6/",MODE:"production",DEV:!1,PROD:!0},xt={name:"OrdersView",props:["token"],data(){return{orders:[],tempOrders:{},page:{},isNew:!1}},components:{Pagination:L,OrderModal:rt,DelorderModal:kt},methods:{...D(C,["showLoading","hideLoading"]),getData(d=1){const e=`${O}api/${f}/admin/orders?page=${d}`;this.$http.get(e).then(i=>{this.orders=i.data.orders,this.page=i.data.pagination,this.hideLoading()}).catch(i=>{alert(i.response.data.message),this.hideLoading()})},openModal(d,e){d==="edit"?(this.tempOrders={...e},this.modal=new v(this.$refs.ordersModal,{keyboard:!1,backdrop:"static"}),this.modal.show()):d==="delete"&&(this.tempOrders={...e},this.modal=new v(this.$refs.delOrderModal,{keyboard:!1,backdrop:"static"}),this.modal.show())},updateOrders(){const d=`${O}api/${f}/admin/order/${this.tempOrders.id}`;this.$http.put(d,{data:this.tempOrders}).then(()=>{this.$swal.fire({toast:!0,position:"top-end",icon:"success",title:"修改優惠券成功",showConfirmButton:!1,timer:1500}),this.modal.hide(),this.getData()}).catch(e=>{alert(e.response.data.message)})},delOrders(){const d=`${O}api/${f}/admin/order/${this.tempOrders.id}`;this.$http.delete(d).then(()=>{this.$swal.fire({toast:!0,position:"top-end",icon:"success",title:"刪除優惠券成功",showConfirmButton:!1,timer:1500}),this.modal.hide(),this.getData()}).catch(e=>{alert(e.data.message)})}},mounted(){this.getData()}},Mt={class:"container-fluid"},wt={class:"table mt-4"},Dt=t("thead",null,[t("tr",null,[t("th",null,"購買時間"),t("th",null,"訂單編號"),t("th",null,"購買款項"),t("th",null,"應付金額"),t("th",null,"是否付款"),t("th",{class:"text-center"},"編輯")])],-1),Ct={class:"list-unstyled"},Lt={key:0,class:"text-success"},Vt={key:1,class:"text-danger"},Pt={class:"text-center"},Et={class:"btn-group"},qt=["onClick"],Tt=["onClick"],At={id:"ordersModal",ref:"ordersModal",class:"modal fade",tabindex:"-1","aria-labelledby":"ordersModalLabel","aria-hidden":"true"},Bt={id:"delOrderModal",ref:"delOrderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"};function It(d,e,i,y,u,c){const p=$("Pagination"),r=$("OrderModal"),h=$("DelorderModal");return l(),a("div",Mt,[t("table",wt,[Dt,t("tbody",null,[(l(!0),a(_,null,m(u.orders,n=>(l(),a("tr",{key:n.id},[t("td",null,s(new Date(n.create_at*1e3).toLocaleDateString()),1),t("td",null,s(n.id),1),t("td",null,[t("ul",Ct,[(l(!0),a(_,null,m(n.products,o=>(l(),a("li",{key:o.id},s(o.product.title)+" ： "+s(o.qty)+" "+s(o.product.unit),1))),128))])]),t("td",null,"$ "+s(n.total),1),t("td",null,[n.is_paid?(l(),a("span",Lt,"已付款")):(l(),a("span",Vt,"未付款"))]),t("td",Pt,[t("div",Et,[t("button",{type:"button",class:"btn btn-sm btn-outline-custom_dark-green",onClick:o=>c.openModal("edit",n)}," 編輯 ",8,qt),t("button",{type:"button",class:"btn btn-sm btn-outline-custom_red ms-md-2",onClick:o=>c.openModal("delete",n)}," 刪除 ",8,Tt)])])]))),128))])]),b(p,{pages:u.page,onChangePage:c.getData},null,8,["pages","onChangePage"]),t("div",At,[b(r,{"temp-orders":u.tempOrders,onUpdateOrders:c.updateOrders},null,8,["temp-orders","onUpdateOrders"])],512),t("div",Bt,[b(h,{"temp-orders":u.tempOrders,onDelOrders:c.delOrders},null,8,["temp-orders","onDelOrders"])],512)])}const Nt=g(xt,[["render",It]]);export{Nt as default};
